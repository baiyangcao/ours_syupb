# 办文自动归档工具—BWBatch

## 概述

需求来自办公室想要归档2014,2015年没有归档办结的来文案件，由于每年都会有这样的没有归档的案件，故制作工具。  
  
此工具根据办文在单击归档按钮进行归档的过程中调用的方法对案件进行归档，首先会模拟用户登录，然后获取需要归档的案件InstanceID，最后进行归档方法调用。

## 配置

### 配置文件`BWBatch.exe.config`

- `appurl` —— 配置应用地址url，用于模拟登录
- `limit` —— 每次执行归档程序时归档的案件个数，-1表示全部归档
- `StartTime`, `EndTime` —— 需归档案件的**录入时间**范围，用于查询归档案件InstanceID
- `UserOID` —— 归档用户的`UCML_UserOID`，要与下面的`UserLogin`一致，用于获取用户在办箱中待归档的案件InstanceID
- `UserLogin`, `PassWord` —— 用户的登录名，密码，用于模拟登录，密码置为超级密码即可
- `IsFroceArchive` —— 是否强制归档，有些不是所有处室都确认办结的案件在单击归档按钮时会提示是否确定归档，这里如果设置为1则强制归档

### SQL配置文件`Config/SQLConfig.xml`

SQL配置文件中用于配置查询需归档案件InstanceID列表的SQL语句，里面只有一个SQL语句，可以通过修改查询的视图和`ActivityID`条件来归档除了发文以外的办文，如阅文等，只有归档逻辑相同即可
