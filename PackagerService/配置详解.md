# 配置详解

## `task`节点
### 概述
定义导出任务，及导出任务的根目录

### 属性列表
| 属性名称 | 默认值 | 属性说明 |
|:------- | ----------- |:------- |
| name | `null` | 任务名称，随意填写，不影响导出结果，用于日志中标识 |
| outputfolder | 必填 | 输出目录属性，作为本次任务导出的根目录，**若为空则跳过当前任务** |


## `flow`节点
### 概述
定义导出流程，并取出导出所用的数据源

### 属性列表
| 属性名称 | 默认值 | 属性说明 |
|:------- | ----------- |:------- |
| name | `null` | 流程名称，随意填写，不影响导出结果，用于日志中标识 |
| sql | 必填 | 获取数据所用的sql语句名称，用SQLGetter.GetSqlByAttr方法获取具体的SQL语句 |
| conn | `conn` | 数据库连接字符串名称，指在Web.config或者App.config文件中配置的连接字符串名称 |
| folder | `null` | 添加子目录名称，为空则不添加子目录 |


## `folder`节点
### 概述
定义子目录，用于在现有的目录上添加一个子目录

### 属性列表
| 属性名称 | 默认值 | 属性说明 |
| ------- | ------ |:------- |
| name | 必填 | 子目录名称 |


## `group`节点
### 概述
定义分组处理，将数据源根据分组字段进行分组，使用分组字段的值作为子目录名称，然后再继续分组处理`group`节点的子节点

### 属性说明
| 属性名称 | 默认值 | 属性说明 |
| ------- | ------ | ------- |
| groupby | 必填 | 分组字段名称 |

## `output`节点
### 概述
定义输出文件，根据输出的对象不同需要配置的节点也不同，输出对象有四类：word、excel、服务、文稿，后两种是为了兼容现有数据库中存储文件对象的两种特殊形式：分段存储、iWebOffice存储的二进制数据，另外，图形数据的导出也是由服务对象来完成

根据四种输出对象配置`output`节点不同的`type`属性，也使得`output`具有不同的属性配置及子节点配置，下面根据不同的`type`值来讲解`output`节点的配置

### `type="word"`配置
需要导出的是word文档，根据模板和数据源及相关配置导出word文档，包括`output`节点属性配置及其子节点的配置

#### `<output type="word" />`属性说明
| 属性名称 | 默认值 | 属性说明 |
| ------- | ------ | ------- |
| conn | `conn` | 数据库连接名称，指在Web.config或App.config文件中配置的数据库连接名，这个连接用于`output`子节点下配置的sql语句 |
| template | `null` | 模板文件名称 |
| parameters | `null` | 根据数据源，过滤需要作为sql参数用于`output`子节点下配置的sql语句的字段列表，用`,`隔开，**一般可以忽略** |
| filenamefield | `{template}` | 数据源中作为导出word文件名的字段名，**默认使用模板名称作为导出文件名** |

#### `<output type="word" />`子节点配置说明
子节点中主要用于配置word模板中的书签、MergeField的数据源，可以配置书签、表格甚至图片的SQL语句，不过图片的支持并不完整  
  
SQL语句的连接字符串在`output`节点中`conn`配置，而SQL语句中的参数则由数据源中的每一条记录来提供，可以通过`output`节点中的`parameters`属性来过滤
  
| 属性名称 | 默认值 | 属性说明 |
| ------- | ------ | ------- |
| `<bookmarksql sql=""/>` |
| sql | 必填 | 获取书签数据的SQL语句名称 |
| `<datatablesql tablename="" sql="" />` |
| tablename | 必填 | 对应word模板中配置的表格名称 |
| sql | 必填 | 用于获取数据的SQL名称 |


> `flow`节点下可以配置`folder`节点添加子目录，也可以配置`group`节点添加分组目录并将`flow`节点中获取的数据源进行分组处理，或者直接配置`output`节点导出文件，其中`folder`和`group`可以配置多层，也可相互嵌套，但叶子节点必须是`output`